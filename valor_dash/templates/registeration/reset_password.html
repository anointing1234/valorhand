{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Valorhand | reset-password</title>
    <!-- plugins:css -->
  <link rel="stylesheet" href="{% static 'vendors/iconfonts/font-awesome/css/all.min.css' %}">
  <link rel="stylesheet" href="{% static 'vendors/css/vendor.bundle.base.css' %}">
  <link rel="stylesheet" href="{% static 'vendors/css/vendor.bundle.addons.css' %}">
  <!-- endinject -->
  <!-- plugin css for this page -->
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    .form-control {
      border: none; /* Remove borders */
      box-shadow: none; /* Remove shadow effect */
  }
  
  .form-control:focus {
      border-color: black; /* Ensure no border color when focused */
      box-shadow: none; /* Remove shadow on focus */
  }
    .bg-image {
        background-image: url("{% static 'images/valor_bg.jpg' %}");
        background-repeat: no-repeat; /* Prevents the image from repeating */
        background-size: cover; /* Scales the image to cover the entire screen */
        background-position: center; /* Centers the image */
    }
    .logo {
      font-family: 'Arial', sans-serif;  /* Change to a more stylish font if desired */
      font-size: 48px;                   /* Larger font size for a logo */
      font-weight: 1000;                  /* Extra bold */
      color:black;                    /* Dark color for the logo */
      text-transform: uppercase;         /* Uppercase letters */
      letter-spacing: 5px;               /* Spacing between letters */
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); /* Soft shadow for depth */
      background: linear-gradient(90deg, #f39c12, #e74c3c); /* Gradient background */
      -webkit-background-clip: text;     /* Show background through text */
      -webkit-text-fill-color: transparent; /* Set text color to transparent */
      margin: 20px 0;
  }
  .card{
    border-radius: 20px;
  } 
</style>
  <!-- endinject -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  
  <body >
    <div class="container-fluid">
      <h5 class="card-title  text-dark text-start py-3 me-3 mt-2 fw-bold ">    VALORHAND | <span>Investment Banking</span></h5>
    </div>
<div class="container-fluid d-flex justify-content-center mt-2 pt-2 py-5" >
    <div class="col-md-4 grid-margin stretch-card">
        <div class="card border-white bg-transparent">
          <div class="card-body">
            <h3 class="text-center text-dark fw-bold mt-2 mb-5">Email reset link
            <p>send email reset link</p>
            </h3>
            <form id="LoginForm" class="forms-sample" method="POST" action="{% url "signin"  %}">
              {% csrf_token %}
              <div class="form-group">
                <label for="exampleInputEmail1 " class="text-dark mt-4">Enter email address</label>
                {{ form.email }}
              </div>
              </div>
              <button  id="forgotPasswordLink" type="button" class="btn btn-dark col-12">Submit request</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    
    <footer class="bg-dark text-white py-4">
      <div class="container">
          <hr class="my-4 bg-light">
          <div class="text-center">
              <p>
                  Valorhand is a business of Valorhand Bank USA, a wholly-owned subsidiary of The Valorhand Group, Inc. Loans and deposit products are provided by Valorhand Bank USA, Salt Lake City branch. Member FDIC.
              </p>
              <p>
                  Securities-based loans may not be appropriate for all parties (e.g., borrowers, pledgors, and guarantors) and carry a number of risks, including but not limited to the risk of a market downturn, tax implications if pledged securities are liquidated, and the potential increase in interest rates. You should consider these risks and whether a securities-based loan is appropriate before proceeding.
              </p>
              <p>
                  Credit qualification and collateral are subject to approval. Additional terms and conditions apply.
              </p>
              <p>
                  Valorhand does not provide legal, tax, or accounting advice. This content is for marketing purposes only and is not a substitute for individualized professional advice. Individuals should consult their own tax advisor for matters specific to their own taxes and nothing communicated to you herein should be considered tax advice.
              </p>
              <p>
                  Â©<span id="year"></span> <!-- Add the element to display the year here -->
                  Valorhand. All Rights Reserved. Valorhand is a registered trademark of Valorhand & Co. LLC.<br>
                  Norton Secured | Equal-opportunity Lender
              </p>
          </div>
      </div>
  </footer>
  <script>
    document.getElementById('year').innerText = new Date().getFullYear();
  </script>
  

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>    
<!-- plugins:js -->
<script src="{% static 'vendors/js/vendor.bundle.base.js' %}"></script>
<script src="{% static 'vendors/js/vendor.bundle.addons.js' %}"></script>
<!-- endinject -->
<!-- Plugin js for this page-->
<!-- End plugin js for this page-->
<!-- inject:js -->
<script src="{% static 'js/off-canvas.js' %}"></script>
<script src="{% static 'js/hoverable-collapse.js' %}"></script>
<script src="{% static 'js/misc.js' %}"></script>
<script src="{% static 'js/settings.js' %}"></script>
<script src="{% static 'js/todolist.js' %}"></script>
<!-- endinject -->
<!-- Custom js for this page-->
<script src="{% static 'js/dashboard.js' %}"></script>
<!-- End custom js for this page-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.getElementById('forgotPasswordLink').addEventListener('click', function (e) {
            e.preventDefault();
            
            // Get the email value from the form
            const emailInput = document.querySelector('input[name="email"]').value;
            
            if (!emailInput) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Please enter your email address.',
                });
                return;
            }
    
            // Show loading spinner
            Swal.fire({
                title: 'Sending request...',
                allowOutsideClick: false,
                onBeforeOpen: () => {
                    Swal.showLoading();
                }
            });
    
            // Verify email
            fetch("{% url 'verify_email' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                body: JSON.stringify({ email: emailInput })
            })            
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Error: ${response.status} ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                if (data.exists) {
                    // If email exists, send the password reset email
                    return fetch("{% url 'password_reset' %}", { // Change to your actual URL
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "X-CSRFToken": "{{ csrf_token }}"
                        },
                        body: JSON.stringify({ email: emailInput })
                    });
                } else {
                    // Show error if email is not found
                    throw new Error('Email not registered.'); // Throw an error to be caught later
                }
            })
            .then(response => {
                if (response.ok) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Success',
                        text: 'Password reset link has been sent to your email. Please check your inbox.',
                    });
                } else {
                    throw new Error('Failed to send password reset email.'); // Handle unexpected response
                }
            })
            .catch(error => {
                console.error(error); // Optional: Log the error for debugging
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: error.message || 'There was an error sending the reset link. Please try again later.',
                });
            });
        });
    </script>
    
    
  </body>
</html>